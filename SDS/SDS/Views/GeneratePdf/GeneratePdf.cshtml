﻿@using System.Web
@using Microsoft.AspNetCore.Html
@using System.Text.RegularExpressions
@using SDS.Helper
@using System;
@using System.IO;
@model SDS.Models.SdsViewModel;


@functions {
    public static HtmlString HtmlRaw(string? content, string defaultValue = "No additional data available.")
    {
        if (string.IsNullOrWhiteSpace(content))
            return new HtmlString(defaultValue);

        var trimmedContent = content.Trim();
        var isEmptyHtml = Regex.IsMatch(trimmedContent,
            @"^<p>\s*<br\s*/?>\s*</p>$",
            RegexOptions.IgnoreCase);

        return new HtmlString(isEmptyHtml ? defaultValue : content);
    }

    public static HtmlString AddOneImage(HeaderHImage imgBinary)
    {
        if (imgBinary != null)
        {
            string content = $@"<img
                src=""{Functions.ConvertByteToBase64Image(imgBinary.ImageData)}""
                alt=""{imgBinary.ContentID}""
                class=""imgStyle""
            />";
            return new HtmlString(content);
        }
        return new HtmlString(string.Empty);
    }

    public static HtmlString PrintOneLine(double no, string title, string data, bool important = false, string imageTag = null, Dictionary<string, List<HeaderHImage>> imagesByContentID = null)
    {
        string content = $@"<tr class=""header-row"">
                                <td class=""section-number"">{no}</td>
                                <td colspan=""6"">{title}</td>
                            </tr>";

        string nullText = important
            ? "No additional data available, but it must be considered that this product may be dangerous for the environment."
            : "No additional data available.";

        if (string.IsNullOrEmpty(data))
        {
            content += $@"<tr class=""content-row"">
                            <td style=""border-right-color: white !important;""></td>
                            <td colspan=""6"">{nullText}</td>
                         </tr>";
        }
        else
        {
            if (!string.IsNullOrEmpty(imageTag) && imagesByContentID != null && imagesByContentID.ContainsKey(imageTag))
            {
                var imgBinary = imagesByContentID[imageTag];
                if (imgBinary != null && imgBinary.Count > 0 && imgBinary[0] != null)
                {
                    data += AddOneImage(imgBinary[0]).Value;
                }
            }

            content += $@"<tr class=""content-row"">
                            <td style=""border-right-color: white !important;""></td>
                            <td colspan=""6"">{HtmlRaw(data)}</td>
                         </tr>";
        }

        return new HtmlString(content);
    }

    public static HtmlString PrintSideBySide(string title, string data, 
        bool bgBlue = false, string fspan = "colspan='2'", string sspan = "colspan='2'")
    {
        string bgClass = bgBlue ? "bgBlue" : "";
        string borderColor = bgBlue ? "#002060" : "white";

        string content = $@"<td class=""{bgClass}"" {fspan} style=""border-right-color: {borderColor} !important;""></td>
                            <td class=""{bgClass} second-col"" {sspan}><b>{title}</b></td>";

        content += $@"<td colspan='3'>{HtmlRaw(data)}</td>";

        string element = $@"<tr class=""content-row"">{HtmlRaw(content)}</tr>";

        return new HtmlString(element);
    }
}

<style>
    *{
        text-align: justify;
    }

    .wrapper {
        display: block;
        overflow: hidden;
        margin-top: 0px;
        padding: 0;
        font-family: Arial, sans-serif;
    }

    .content {
        margin-left: 0px;
        padding: 0 2rem 0 2rem;
        flex-grow: 1;
        overflow-y: auto;
        background-color: #fff;
    }

    .navbar, .sidebar {
        display: none;
    }

    .header-row {
        background-color: #00285b;
        color: white;
        font-weight: bold;
    }

    .header-row .header-row-child {
        background-color: white;
        color: black;
    }

    .sec-header-row {
        background-color: #00285b !important;
        font-weight: bold;
        color: white;
        padding: 8px;
    }

    .section-number {
        width: 7.5%;
    }

    .fw-bold {
        font-weight: bold;
    }

    .fst-italic {
        font-style: italic;
    }

    .table {
        border: 1px solid #000;
    }

    tbody, td, tfoot, th, thead {
        border: 0.5px solid gray !important;
        padding: 5px !important;
    }

    td{
        padding: 10px !important;
    }
    
    td, th{
        padding-right: 43px !important;
    }

    h5{
        text-align:left !important;
        text-justify: auto !important;
    }

    .noRightB {
        border-right: 0px;
        white-space: nowrap;
    }

    .four-fw-bold {
        background-color: #00285b !important;
        color: white; /* Add for contrast */
    }

    .safety-data-sheet {
        font-weight: bolder;
        border: 2px solid #000000;
        font-size: 2rem;
        font-family: Georgia, serif;
        background-color: #fcc73b;
        display: inline-block;
        padding: 0.5% 5% !important;
        margin-bottom: 2rem;
    }

    .main-title {
        font-weight: bold;
        font-size: 16px;
        margin-bottom: 5px;
        text-decoration: underline;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        border: 1px solid #000;
    }

    .header-row {
        background-color: #002060;
        color: white;
        font-weight: bold;
    }

    .header-row td {
        padding: 5px 10px;
        border: 1px solid #000;
    }

    .content-row td {
        padding: 5px 10px;
        border: 1px solid #000;
        background-color: white;
    }

    .section-number {
        font-weight: bold;
    }

    .category-cell {
        width: 35%;
        font-weight: bold;
    }

    .bgBlue {
        background-color: #002060 !important;
        color: white;
    }

    .first-col {
        width: 35px;
    }

    .second-col {
        width: 30%;
    }

    .imgStyle {
        width: 105px;
        height: 105px;
        object-fit: cover;
    }

    .sdsHeader{
        width:30%;
    }
    .text-decoration-underline{
        font : bold;
    }
</style>

<div class="text-center mb-2">
    <p class="safety-data-sheet">Safety Data Sheet</p>
</div>
<div>
    <!-- Section 1 Table -->
    <h6 class="text-decoration-underline" style="text-justify:auto">01. IDENTIFICATION OF THE SUBSTANCE/PREPARATION & THE COMPANY/UNDERTAKING</h6>
    <table class="table table-bordered mb-3">
        <tbody>
            <!-- Section 1.1 -->
            <tr class="header-row">
                <th class="section-number">1.1</th>
                <th colspan="6">Product Identifier</th>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold">Product Name</th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.ProductName)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold">Biological Definition</th>
                <td colspan="5" class="fst-italic text-align">@HtmlRaw(Model.BiologicalDefinition)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold">INCI Name</th>
                <td colspan="5" class="fst-italic text-align">@HtmlRaw(Model.InciName)</td>
            </tr>
            <tr>
                <th class="fw-bold">CAS #</th>
                <td colspan="2" class="text-align">@HtmlRaw(Model.CasNumber)</td>
                <th class="fw-bold noRightB">FEMA #</th>
                <td colspan="1" class="text-align">@HtmlRaw(Model.FemaNumber)</td>
                <th class="fw-bold noRightB">EINECS #</th>
                <td colspan="1" class="text-align">@HtmlRaw(Model.EinecsNumber)</td>
            </tr>

            <!-- Section 1.2 -->
            <tr class="header-row">
                <th class="section-number">1.2</th>
                <th colspan="6">Relative identified uses of the substance or mixture and uses advised against</th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.IdentifiedUses)</td>
            </tr>

            <!-- Section 1.3 -->
            <tr class="header-row">
                <th class="section-number">1.3</th>
                <th colspan="6">Details of the supplier of the safety data sheet</th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.SupplierDetails)</td>
            </tr>

            <!-- Section 1.4 -->
            <tr class="header-row">
                <th class="section-number">1.4</th>
                <th colspan="2">Emergency Tel. No.</th>
                <td colspan="4" class="header-row-child text-align">@HtmlRaw(Model.EmergencyPhone)</td>
            </tr>
        </tbody>
    </table>

    <!-- Section 2 Table -->
    <h6 class="text-decoration-underline">02. HAZARDS IDENTIFICATION</h6>
    <table class="table table-bordered mb-3">
        <tbody>
            <!-- Section 2.1 -->
            <tr class="header-row">
                <th class="section-number">2.1</th>
                <th colspan="6">Classification of the substance or mixture</th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">
                    @HtmlRaw(Model.ClassificationContent)
                </td>
            </tr>

            <!-- Section 2.2 -->
            <tr class="header-row">
                <th class="section-number">2.2</th>
                <th colspan="6">Label Elements</th>
            </tr>
            <tr class="header-row">
                <th colspan="7" class="text-align">@HtmlRaw(Model.LabelContent)</th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6">
                    @if (Model.ImagesByContentID.TryGetValue(ImageIds.labelImage, out var images))
                    {
                        <div style="display: flex; flex-direction: row; gap: 1rem;">
                            @foreach (var image in images)
                            {
                                <div style="display: flex; flex-direction: column; align-items: center;">
                                    <img src="@Functions.ConvertByteToBase64Image(image.ImageData)"
                                         alt="@image.ImageName"
                                         style="width: 60px; height: 60px;">
                                    <span style="font-size: 0.7rem; color: #6c757d; margin-top: 0.25rem;">@image.ImageName</span>
                                </div>
                            }
                        </div>
                    }
                    else
                    {
                        <p>No additional data available.</p>
                    }
                </td>
            </tr>
            <tr class="header-row">
                <th colspan="2">Signal Word</th>
                <td colspan="5" class="header-row-child text-align">@HtmlRaw(Model.SignalWord)</td>
            </tr>
            <tr class="header-row">
                <th colspan="2">Contains</th>
                <td colspan="5" class="header-row-child text-align">@HtmlRaw(Model.ContainsInfo)</td>
            </tr>

            <tr class="header-row">
                <th colspan="7">Hazard Statements</th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.HazardStatements)</td>
            </tr>

            <!-- Section 2.3 -->
            <tr class="header-row">
                <th class="section-number">2.3</th>
                <th colspan="6">Other Hazards</th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-justify text-align">@HtmlRaw(Model.OtherHazards)</td>
            </tr>
        </tbody>
    </table>

    <!-- Section 3 Table -->
    <h6 class="text-decoration-underline">03. COMPOSITION/INFORMATION ON INGREDIENTS</h6>
    <table class="table table-bordered mb-3">
        <tbody>
            <!-- Section 3.1 -->
            <tr class="header-row">
                <th class="section-number">3.1</th>
                <th colspan="6">
                    Substances
                </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">
                    @HtmlRaw(Model.ClassificationContent)
                </td>
            </tr>
        </tbody>
    </table>

    <!-- Section 4 -->
    <h6 class="text-decoration-underline ">04. FIRST AID MEASURES</h6>
    <table class="table table-bordered">
        <tbody>
            <tr class="header-row">
                <th class="section-number">4.1</th>
                <th colspan="6"> Description of first aid measures </th>
            </tr>
            <tr>
                <th colspan="2" class="bgBlue">Inhalation</th>
                <td colspan="5" class="text-align"> @HtmlRaw(Model.InhalationFirstAid)</td>
            </tr>
            <tr>
                <th colspan="2" class="bgBlue"> Ingestion </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.IngestionFirstAid)</td>
            </tr>
            <tr>
                <th colspan="2" class="bgBlue"> Skin Contact </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.SkinContactFirstAid)</td>
            </tr>
            <tr>
                <th colspan="2" class="bgBlue">Eye Contact</th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.EyeContactFirstAid)</td>
            </tr>

            <tr class="header-row">
                <th class="section-number">4.2</th>
                <th colspan="6">
                    Most important symptoms and effects, both acute and delayed
                </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">
                    @HtmlRaw(Model.SymptomsEffects)
                </td>
            </tr>

            <tr class="header-row">
                <th class="section-number">4.3</th>
                <th colspan="6">
                    Most important symptoms and effects, both acute and delayed
                </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">
                    @HtmlRaw(Model.MedicalAttention)
                </td>
            </tr>
        </tbody>
    </table>

    <!-- Section 5 Table -->
    <h6 class="text-decoration-underline ">05. FIRE-FIGHTING MEASURES</h6>
    <table class="table table-bordered mb-3">

        <tbody>
            <!-- 5.1 -->
            <tr class="header-row">
                <th class="section-number">5.1</th>
                <th colspan="6"> Extinguishing Media </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.ExtinguishingMediaContent)</td>
            </tr>

            <!-- 5.2 -->
            <tr class="header-row">
                <th class="section-number">5.2</th>
                <th colspan="6"> Special hazards arising from the product </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.SpecialHazardsContent)</td>
            </tr>

            <!-- 5.3 -->
            <tr class="header-row">
                <th class="section-number">5.3</th>
                <th colspan="6"> Advice for firefighters </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">
                    @HtmlRaw(Model.FirefighterAdviceContent)
                </td>
            </tr>
        </tbody>
    </table>

    <!---Section 6 Table  -->
    <h6 class="text-decoration-underline ">06. ACCIDENTAL RELEASE MEASURES</h6>
    <table class="table table-bordered">
        <tbody>
            <!-- 6.1 -->
            <tr class="header-row">
                <th class="section-number">6.1</th>
                <th colspan="6"> Personal precautions, protective equipment and emergency procedures </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.PersonalPrecautions)</td>
            </tr>

            <!-- 6.2 -->
            <tr class="header-row">
                <th class="section-number">6.2</th>
                <th colspan="6"> Environmental Precautions </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.EnvironmentalPrecautions)</td>
            </tr>
            <!-- 6.3 -->
            <tr class="header-row">
                <th class="section-number">6.3</th>
                <th colspan="6"> Methods and material for containment and cleaning up. </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.ContainmentMethods)</td>
            </tr>

            <!-- 6.4 -->
            <tr class="header-row">
                <th class="section-number">6.4</th>
                <th colspan="6"> Reference to other sections  </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.SectionReferences)</td>
            </tr>
        </tbody>
    </table>

    <!---Section 7 Table  -->
    <h6 class="text-decoration-underline ">07. HANDLING AND STORAGE</h6>
    <table class="table table-bordered">
        <tbody>
            <!-- 7.1 -->
            <tr class="header-row">
                <th class="section-number">7.1</th>
                <th colspan="6"> Precautions for safe handling  </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.SafeHandlingPrecautions)</td>
            </tr>

            <!-- 7.2 -->
            <tr class="header-row">
                <th class="section-number">7.2</th>
                <th colspan="6"> Conditions for safe storage, including any incompatibilities  </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.SafeStorageConditions)</td>
            </tr>
            <!-- 7.3 -->
            <tr class="header-row">
                <th class="section-number">7.3</th>
                <th colspan="6"> Specific end use(s)   </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.SpecificEndUses)</td>
            </tr>

        </tbody>
    </table>

    <!---Section 8 Table  -->
    <h6 class="text-decoration-underline">08. EXPOSURE CONTROLS/PERSONAL PROTECTION</h6>
    <table class="table table-bordered mb-3">
        <tbody>
            <tr class="header-row">
                <th class="section-number">8.1</th>
                <th colspan="6">Control Parameters</th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.ControlParameters)</td>
            </tr>
            <tr class="header-row">
                <th class="section-number">8.2</th>
                <th colspan="6">Exposure Controls</th>
            </tr>
            <tr>
                <th colspan="7">Protective Equipment</th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6">
                    @if (Model.ImagesByContentID.TryGetValue(ImageIds.protectiveEquipmentImage, out var ProtectiveEquipmentImages))
                    {
                        <div style="display: flex; flex-direction: row; gap: 1rem;">
                            @foreach (var image in ProtectiveEquipmentImages)
                            {
                                <div style="display: flex; flex-direction: column; align-items: center;">
                                    <img src="@Functions.ConvertByteToBase64Image(image.ImageData)"
                                         alt="@image.ImageName"
                                         style="width: 60px; height: 60px;">
                                    @* <span style="font-size: 0.7rem; color: #6c757d; margin-top: 0.25rem;">@image.ImageName</span> *@
                                </div>
                            }
                        </div>
                    }
                    else
                    {
                        <p>No additional data available.</p>
                    }
                </td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Process Conditions
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.ProcessConditions)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Engineering Measures
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.EngineeringMeasures)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Respiratory Equipment
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.RespiratoryEquipment)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Hand Protection
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.HandProtection)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Eye Protection
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.EyeProtection)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Other Protection
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.OtherProtection)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Hygiene Measures
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.HygieneMeasures)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Personal Protection
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.PersonalProtection)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Skin Protection
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.SkinProtection)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Environmental Exposure Control
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.EnvironmentalExposure)</td>
            </tr>
        </tbody>
    </table>

    <!-- Section 9 Table -->
    <h6 class="text-decoration-underline">09. PHYSICAL AND CHEMICAL PROPERTIES</h6>
    <table class="table table-bordered mb-3">
        <tbody>
            <!-- Section 9.1 -->
            <tr class="header-row">
                <th class="section-number">9.1</th>
                <th colspan="6">Information on basic physical and chemical properties</th>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Appearance
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.Appearance)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Colour
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.Colour)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Odour
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.Odour)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Relative Density
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.RelativeDensity)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Flash Point (°C)
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.FlashPoint)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Melting Point (°C)
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.MeltingPoint)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Refractive Index
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.RefractiveIndex)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Boiling Point (°C)
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.BoilingPoint)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Vapour Pressure
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.VapourPressure)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Solubility in Water @@ 20°C
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.SolubilityInWater)</td>
            </tr>
            <tr>
                <th colspan="2" class="fw-bold sdsHeader">
                    Auto-ignition temperature (°C)
                </th>
                <td colspan="5" class="text-align">@HtmlRaw(Model.AutoIgnitionTemp)</td>
            </tr>

            <!-- Section 9.2 -->
            <tr class="header-row">
                <th class="section-number">9.2</th>
                <th colspan="6">Other information</th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6">@HtmlRaw(Model.OtherChemicalInfo)</td>
            </tr>
        </tbody>
    </table>

    <!-- Section 10 Table -->
    <h6 class="text-decoration-underline">10. STABILITY AND REACTIVITY</h6>
    <table class="table table-bordered mb-3 ">
        <tbody>
            <!-- Section 10.1 -->
            <tr class="header-row">
                <th class="section-number">10.1</th>
                <th colspan="6">
                    Reactivity
                </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.ReactivityInfo)</td>
            </tr>

            <!-- Section 10.2 -->
            <tr class="header-row">
                <th class="section-number">10.2</th>
                <th colspan="6">
                    Chemical stability
                </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.ChemicalStability)</td>
            </tr>

            <!-- Section 10.3 -->
            <tr class="header-row">
                <th class="section-number">10.3</th>
                <th colspan="6">
                    Possible hazardous reactions
                </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.HazardousReactions)</td>
            </tr>

            <!-- Section 10.4 -->
            <tr class="header-row">
                <th class="section-number">10.4</th>
                <th colspan="6">
                    Conditions to Avoid
                </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.ConditionsToAvoid)</td>
            </tr>

            <!-- Section 10.5 -->
            <tr class="header-row">
                <th class="section-number">10.5</th>
                <th colspan="6">
                    Incompatible materials
                </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.IncompatibleMaterials)</td>
            </tr>

            <!-- Section 10.6 -->
            <tr class="header-row">
                <th class="section-number">10.6</th>
                <th colspan="6">
                    Hazardous Decomposition Products
                </th>
            </tr>
            <tr>
                <td style="border-right-color: white !important;"></td>
                <td colspan="6" class="text-align">@HtmlRaw(Model.HazardousDecomposition)</td>
            </tr>
        </tbody>
    </table>

    <!-- Section 11 Table -->
    <h6 class="text-decoration-underline">11. TOXICOLOGICAL INFORMATION</h6>
    <table id="section-11-data" class="mb-3 ">
        <tr class="header-row">
            <td class="section-number">11.1</td>
            <td colspan="6">Information on toxicological effects</td>
        </tr>
        @Html.Raw(PrintSideBySide("Acute Toxicity", Model.AcuteToxicity, default, default, "colspan='1' class='text-align'"))
        @Html.Raw(PrintSideBySide("Skin corrosion/irritation", Model.SkinCorrosion, default, default, "colspan='1'"))
        @Html.Raw(PrintSideBySide("Eye Damage", Model.EyeDamage, default, default, "colspan='1'"))
        @Html.Raw(PrintSideBySide("Respiratory or skin sensitisation", Model.SkinSensitization, default, default, "colspan='1'"))
        @Html.Raw(PrintSideBySide("Germ Cell Mutagenicity", Model.GermCell, default, default, "colspan='1'"))
        @Html.Raw(PrintSideBySide("Carcinogenicity", Model.Carcinogenicity, default, default, "colspan='1'"))
        @Html.Raw(PrintSideBySide("Reproductive toxicity", Model.ReproductiveToxicity, default, default, "colspan='1'"))
        @Html.Raw(PrintSideBySide("STOT-single exposure", Model.SingleExposure, default, default, "colspan='1'"))
        @Html.Raw(PrintSideBySide("STOT-repeated exposure", Model.RepeatedExposure, default, default, "colspan='1'"))
        @Html.Raw(PrintSideBySide("Aspiration hazard", Model.AspirationHazard, default, default, "colspan='1'"))
        @Html.Raw(PrintSideBySide("Photo-toxicity", Model.PhotoToxicity, default, default, "colspan='1'"))
        @Html.Raw(PrintSideBySide("Other Information", Model.OtherInfo, default, default, "colspan='1'"))
    </table>

    <!-- Section 12 Table -->
    <h6 class="text-decoration-underline">12. ECOLOGICAL INFORMATION</h6>
    <table id="section-12-data" class="mb-3 ">
        @Html.Raw(PrintOneLine(12.1, "Toxicity", Model.EcoToxicity, true))
        @Html.Raw(PrintOneLine(12.2, "Persistence & degradability", Model.PersistenceDegradability))
        @Html.Raw(PrintOneLine(12.3, "Bioaccumulation Potential", Model.BioaccumulationPotential))
        @Html.Raw(PrintOneLine(12.4, "Mobility in soil", Model.SoilMobility))
        @Html.Raw(PrintOneLine(12.5, "Results of PBT and vPvB Assessment", Model.PbtAssessment))
        @Html.Raw(PrintOneLine(12.6, "Other adverse effects", Model.OtherAdverseEffects))
    </table>

    <!-- Section 13 Table -->
    <h6 class="text-decoration-underline" >13. DISPOSAL CONSIDERATIONS</h6>
    <table id="section-13-data" class="mb-3 ">
        @Html.Raw(PrintOneLine(13.1, "Waste treatment methods", Model.WasteTreatmentMethod))
    </table>

    <!-- Section 14 Table -->
    <h6 class="text-decoration-underline">14. TRANSPORT INFORMATION</h6>
    <table id="section-14-data" class="mb-3 ">
        <tr class="header-row">
            <td colspan="1" class="section-number">14.1</td>
            <td colspan="6">UN number</td>
        </tr>
        @Html.Raw(PrintSideBySide("UN No. Road", Model.UnRoad, true, default, "colspan='2'"))
        @Html.Raw(PrintSideBySide("UN No. SEA", Model.UnSea, true, default, "colspan='2'"))
        @Html.Raw(PrintSideBySide("UN No. AIR", Model.UnAir, true, default, "colspan='2'"))
        @Html.Raw(PrintOneLine(14.2, "UN proper shipping name", Model.ShippingName))
        @Html.Raw(PrintOneLine(14.3, "Transport hazard class(es)", Model.HazardClass, false, "hazardClass", Model.ImagesByContentID))
        @Html.Raw(PrintOneLine(14.4, "Packing group", Model.PackingGroup))
        @Html.Raw(PrintOneLine(14.5, "Environmental hazards", Model.EnvironmentalHazards, false, "environmentalHazards", Model.ImagesByContentID))
        @Html.Raw(PrintOneLine(14.6, "Special precautions for user", Model.SpecialPrecautions))
        @Html.Raw(PrintOneLine(14.7, $"Transport in bulk according to {Model.BulkTranprt}", Model.IbcCode))
    </table>

    <!-- Section 15 Table -->
    <h6 class="text-decoration-underline">15. REGULATORY INFORMATION</h6>
    <table id="section-15-data" class="mb-3 ">
        @Html.Raw(PrintOneLine(15.1, "Safety, health and environmental regulations/legislation specific for the substance or mixture", Model.SafetyRegulations))
        @Html.Raw(PrintOneLine(15.2, "Chemical safety assessment", Model.ChemicalSafetyAssessment))
    </table>

    <!-- Section 16 Table -->
    <h6 class="text-decoration-underline">16. OTHER INFORMATION</h6>
    <table id="section-16-data" class="mb-3 ">
        @* @Html.Raw(PrintSideBySide("Hazard and/or Precautionary Statements in Full", Model.PrecautionaryStatements, true, "colspan='1'", "colspan='6'")) *@
        @* @Html.Raw(PrintSideBySide("Other Information", Model.OtherInformation, true, "colspan='1'", "colspan='6'")) *@
        @* @Html.Raw(PrintSideBySide("Revision Date", Model.RevisionDate.ToString(), true, "colspan='1'", "colspan='6'")) *@
        @* @Html.Raw(PrintSideBySide("Reason for revision", Model.RevisionReason, true, "colspan='1'", "colspan='6'")) *@
        @* @Html.Raw(PrintSideBySide("Rev No/Repl, SDS Generated", Model.RevNo, true, "colspan='1'", "colspan='6'")) *@
        <tr>
            <th colspan="2" class="fw-bold sdsHeader">
                Hazard and/or Precautionary Statements in Full
            </th>
            <td colspan="5" class="text-align">@HtmlRaw(Model.PrecautionaryStatements)</td>
        </tr>
        <tr>
            <th colspan="2" class="fw-bold sdsHeader">
                Other Information
            </th>
            <td colspan="5" class="text-align">@HtmlRaw(Model.OtherInformation)</td>
        </tr>
        <tr>
            <th colspan="2" class="fw-bold sdsHeader">
                Revision Date
            </th>
            <td colspan="5" class="text-align">@HtmlRaw(Model.RevisionDate.ToString())</td>
        </tr>
        <tr>
            <th colspan="2" class="fw-bold sdsHeader">
                Reason for revision
            </th>
            <td colspan="5" class="text-align">@HtmlRaw(Model.RevisionReason)</td>
        </tr>
        <tr>
            <th colspan="2" class="fw-bold sdsHeader">
                Rev No/Repl, SDS Generated
            </th>
            <td colspan="5" class="text-align">@HtmlRaw(Model.RevNo)</td>
        </tr>
    </table>
</div>

@section Scripts {
    <script>
        function getValueBetweenTags(htmlString, tag) {
          const regex = new RegExp(`<${tag}[^>]*>(.*?)<\\/${tag}>`, 'i');
          const match = htmlString.match(regex);
          return match ? match[1] : null;
        }

        function parseBAndPTags(key, value, htmlString) {
            const tagRegex = new RegExp(`<(${key}|${value})[^>]*>(.*?)<\\/\\1>`, "gi");
            const matches = [...htmlString.matchAll(tagRegex)];

          const resultMap = new Map();
          let currentKey = null;

          for (const match of matches) {
            const tag = match[1].toLowerCase();
            const content = match[2];

            if (tag === key) {
              currentKey = content;
              resultMap.set(currentKey, null);
            } else if (tag === value && currentKey) {
              resultMap.set(currentKey, content);
              currentKey = null;
            }
          }

          return resultMap;
        }

        function loopDoubleSection(data, bgBlue = false){
            let headerTag = 'b'
            let bodyTag = 'p'
            let content = ''
            if(data == null || data.length == 0){
                content += `<tr class="content-row"><td></td><td>No additional data available.</td></tr>`
            }else{
                let resultMap = parseBAndPTags(headerTag, bodyTag, data);
                for (const [title, value] of resultMap.entries()) {
                    content += printSideBySide(title, value, bgBlue)};
                }
            }
            return content;
        }
    </script>
}